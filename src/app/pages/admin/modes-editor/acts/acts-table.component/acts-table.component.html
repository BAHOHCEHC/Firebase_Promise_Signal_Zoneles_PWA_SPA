<section class="acts-section">
  <div class="section-header">
    <h2 class="section-title">Acts</h2>

    <button class="btn-icon" (click)="onRefresh()" title="Refresh">
      <span class="material-symbols-outlined refresh">refresh</span>
    </button>
  </div>

  <!-- Стан завантаження -->
  @if (loading) {
  <div class="loading-state">
    <span class="material-symbols-outlined spin">progress_activity</span>
    <p>Loading acts...</p>
  </div>
  }

  <!-- Помилка -->
  @else if (error) {
  <div class="error-state">
    <span class="material-symbols-outlined">error</span>
    <p>{{ error }}</p>
    <button class="btn secondary" (click)="onRefresh()">Try Again</button>
  </div>
  }

  <!-- Секції з актами -->
  @else if (acts.length > 0) {
  <!-- Проходимо по кожній секції -->
  @for (section of sortedActs(); track section.type) {
  <div class="act-section-group">
    <!-- Заголовок секції -->
    <div class="section-group-header">
      <span class="material-symbols-outlined section-icon">
        {{ getTypeIcon(section.type) }}
      </span>
      <h3 [ngClass]="{
  'section-group-title': true,
  'fight_variation': section.type === 'Variation_fight',
  'fight_boss': section.type === 'Boss_fight',
  'fight_arcana': section.type === 'Arcana_fight'
}">{{ section.title }}</h3>
      <span [ngClass]="{
  'fight_variation': section.type === 'Variation_fight',
  'fight_boss': section.type === 'Boss_fight',
  'fight_arcana': section.type === 'Arcana_fight'
}" class="section-count">({{ section.acts.length }})</span>
    </div>

    <!-- Контейнер для актів -->
    <div class="acts-grid">
      <!-- Заголовки колонок -->
      <div class="acts-grid-header">
        <div class="grid-cell act-name-header">Act Name</div>
        <div class="grid-cell act-type-header">Type</div>
        <div class="grid-cell act-options-header">Options</div>
        <div class="grid-cell act-actions-header">Actions</div>
      </div>

      <!-- Рядки з актами -->
      @for (act of section.acts; track act.id) {
      <div class="act-card">
        <!-- Назва акта -->
        <div class="grid-cell act-name-cell">
          <div class="act-name-content">
            <span class="act-name-text">{{ getActDisplayName(act) }}</span>
          </div>
        </div>

        <!-- Тип акта -->
        <div class="grid-cell act-type-cell">
          <span class="type-badge" [class]="act.type">
            {{ getTypeDisplay(act.type) }}
          </span>
        </div>

        <!-- Опції -->
        <div class="grid-cell act-options-cell">
          @if (getActiveOptions(act).length > 0) {
          <div class="options-list">
            @for (option of getActiveOptions(act); track option) {
            <span class="option-badge">{{ option }}</span>
            }
          </div>
          } @else {
          <span class="no-options">No options</span>
          }
        </div>

        <!-- Дії -->
        <div class="grid-cell act-actions-cell ">
          <button class="btn-icon edit-btn" (click)="onEditClick(act)" title="Edit Act">
            <svg class="color-green" xmlns="http://www.w3.org/2000/svg" width="22" height="22" viewBox="0 0 24 24"
              fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"></path>
              <path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"></path>
            </svg>
          </button>
          <button class="btn-icon delete-btn" (click)="onDeleteClick(act)" title="Delete Act">
            <svg class="red" xmlns="http://www.w3.org/2000/svg" width="22" height="22" viewBox="0 0 24 24" fill="none"
              stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <polyline points="3 6 5 6 21 6"></polyline>
              <path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"></path>
            </svg>
          </button>
        </div>
      </div>
      }
    </div>
  </div>
  }

  <!-- Підсумок -->
  <div class="table-footer">
    <span class="count-info">Total: {{ totalActsCount() }} acts</span>
  </div>
  }

  <!-- Порожній стан -->
  @else {
  <div class="empty-state">
    <span class="material-symbols-outlined">inbox</span>
    <p>No acts found. Create your first act!</p>
  </div>
  }
</section>
